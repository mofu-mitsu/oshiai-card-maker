<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ãƒ¡ã‚¿ã‚¿ã‚°ãƒ»OGPè¨­å®š -->
    <title>æ¨ã—æ„›çˆ†ç™ºâ™¡ã‚«ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ | ã‚¸ã‚§ãƒŸç‰¹è£½</title>
    <meta name="description" content="æ¨ã—ã®å°Šã•ã‚’1æšã®ã‚«ãƒ¼ãƒ‰ã«å‡ç¸®ï¼å†™çœŸã€åè¨€ã€å¸ƒæ•™ãƒã‚¤ãƒ³ãƒˆã‚’ã¾ã¨ã‚ã¦ã‚·ã‚§ã‚¢ã—ã‚ˆã†â™¡">
    <meta property="og:title" content="æ¨ã—æ„›çˆ†ç™ºâ™¡ã‚«ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼">
    <meta property="og:description" content="ã‚ãªãŸã®æ¨ã—ã‚’å¸ƒæ•™ã—ã‚ˆã†ï¼ç”»åƒã¨åè¨€ã§ä½œã‚‹ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚«ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚">
    <meta property="og:type" content="website">
    
    <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ§</text></svg>">

    <!-- ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@300;500&family=M+PLUS+Rounded+1c:wght@400;700&display=swap');

        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #fdfcf8;
            color: #5a5a5a;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 10px;
            margin: 0;
            overflow-x: hidden;
        }

        h1 {
            color: #ff8ba7;
            font-family: 'Kiwi Maru', serif;
            font-weight: 500;
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .subtitle {
            text-align: center;
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 30px;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            justify-content: center;
            align-items: flex-start;
            max-width: 1000px;
            width: 100%;
        }

        /* --- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒªã‚¢ --- */
        .editor {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.03);
            border: 1px solid #f0f0f0;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 0.95rem;
            color: #777;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #f0f0f0;
            border-radius: 12px;
            font-family: inherit;
            box-sizing: border-box;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus, textarea:focus {
            border-color: #ffb7c5;
            outline: none;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* --- ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º --- */
        /* æœ¬æ¥ã®inputã‚¿ã‚°ã¯éš ã™ */
        input[type="file"] {
            display: none;
        }

        /* ã‚«ã‚¹ã‚¿ãƒ ãƒ©ãƒ™ãƒ«ã‚’ãƒœã‚¿ãƒ³é¢¨ã«ã™ã‚‹ */
        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: #fff0f5;
            color: #d65d7a;
            border: 2px dashed #ffb7c5;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
            width: 100%;
            box-sizing: border-box;
        }

        .file-upload-label:hover {
            background: #ffe6ee;
            border-color: #ff8ba7;
        }

        .file-name-display {
            font-size: 0.8rem;
            color: #aaa;
            margin-top: 5px;
            display: block;
            text-align: center;
        }

        /* --- ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ --- */
        .color-picker-wrapper {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        input[type="color"] {
            display: block; /* display:noneã¯è§£é™¤ */
            appearance: none; /* æ¨™æº– */
            -webkit-appearance: none; /* Safari/Chromeç”¨ */
            border: none;
            width: 50px;
            height: 50px;
            cursor: pointer;
            border-radius: 50%;
            padding: 0;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            background: none;
        }
        
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0; 
        }
        
        input[type="color"]::-webkit-color-swatch {
            border: 3px solid #fff;
            border-radius: 50%;
        }

        /* --- ã‚«ãƒ¼ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ --- */
        .preview-area {
            flex: 1;
            min-width: 320px;
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        #oshi-card {
            width: 340px;
            background: linear-gradient(135deg, #ffdde1 0%, #ee9ca7 100%);
            border-radius: 24px;
            padding: 24px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
            color: #fff;
            box-sizing: border-box;
            transform-style: preserve-3d;
        }

        .card-inner {
            background: rgba(255, 255, 255, 0.92);
            border-radius: 18px;
            padding: 25px 20px;
            color: #555;
            text-align: center;
            border: 2px dashed rgba(0,0,0,0.08);
            position: relative;
            z-index: 2;
        }

        .oshi-image-frame {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            background: #fafafa;
            margin: 0 auto 15px;
            overflow: hidden;
            border: 5px solid #fff;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .oshi-image-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .oshi-image-placeholder {
            color: #e0e0e0;
            font-size: 2.5rem;
        }

        .oshi-name {
            font-family: 'Kiwi Maru', serif;
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
            line-height: 1.2;
        }

        .oshi-title {
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 18px;
            background: #f4f4f4;
            display: inline-block;
            padding: 4px 12px;
            border-radius: 50px;
        }

        .section-title {
            font-size: 0.75rem;
            font-weight: bold;
            color: #aaa;
            margin: 15px 0 8px;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .section-title::before, .section-title::after {
            content: '';
            display: block;
            width: 20px;
            height: 1px;
            background: #ddd;
        }

        .oshi-charm {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 20px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .oshi-quote-box {
            background: #fff8fa;
            padding: 18px;
            border-radius: 12px;
            position: relative;
            margin-top: 15px;
            text-align: center;
        }

        .icon-quote {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            padding: 0 10px;
            color: #ffb7c5;
            font-size: 1.2rem;
        }

        .oshi-quote {
            font-family: 'Kiwi Maru', serif;
            font-size: 1.15rem;
            color: #d65d7a;
            font-style: italic;
            line-height: 1.5;
        }

        .watermark {
            margin-top: 20px;
            font-size: 0.65rem;
            color: #ccc;
            text-align: right;
            opacity: 0.7;
        }

        /* --- ãƒœã‚¿ãƒ³ --- */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            width: 100%;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            font-family: 'M PLUS Rounded 1c', sans-serif;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:active {
            transform: scale(0.96);
        }

        #btn-save {
            background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 154, 158, 0.4);
        }

        #btn-share {
            background: #444;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* ã‚¹ãƒãƒ›å‘ã‘èª¿æ•´ */
        @media (max-width: 600px) {
            h1 { font-size: 1.5rem; }
            .container { gap: 20px; }
            .editor { padding: 20px; border-radius: 20px;}
            #oshi-card { width: 100%; max-width: 320px; }
            .action-buttons { flex-direction: column; width: 100%; max-width: 320px; }
            button { width: 100%; justify-content: center; }
        }

    </style>
</head>
<body>

    <h1><i class="fa-solid fa-heart" style="color:#ffb7c5;"></i> æ¨ã—æ„›çˆ†ç™ºâ™¡ã‚«ãƒ¼ãƒ‰</h1>
    <p class="subtitle">ç”»åƒã¨åè¨€ã‚’å…¥åŠ›ã—ã¦ã€æœ€å¼·ã®å¸ƒæ•™ã‚«ãƒ¼ãƒ‰ã‚’ä½œã‚ã†ï¼</p>

    <div class="container">
        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="editor">
            <div class="input-group">
                <label><i class="fa-solid fa-palette"></i> ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼ï¼ˆã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</label>
                <div class="color-picker-wrapper">
                    <input type="color" id="bg-color-1" value="#ffdde1" title="é–‹å§‹è‰²">
                    <i class="fa-solid fa-arrow-right" style="color:#ddd;"></i>
                    <input type="color" id="bg-color-2" value="#ee9ca7" title="çµ‚äº†è‰²">
                </div>
            </div>

            <div class="input-group">
                <label><i class="fa-regular fa-image"></i> æ¨ã—ã®å°Šã„ç”»åƒ</label>
                <!-- ã“ã“ã‚’å¤‰æ›´ï¼éš ã—inputã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ©ãƒ™ãƒ« -->
                <input type="file" id="image-upload" accept="image/*">
                <label for="image-upload" class="file-upload-label">
                    <i class="fa-solid fa-cloud-arrow-up"></i> ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                </label>
                <span id="file-name-display" class="file-name-display">ï¼ˆé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼‰</span>
            </div>

            <div class="input-group">
                <label><i class="fa-solid fa-tag"></i> æ¨ã—ã®åå‰</label>
                <input type="text" id="input-name" placeholder="ä¾‹ï¼šã‚¸ã‚§ãƒŸã¡ã‚ƒã‚“">
            </div>

            <div class="input-group">
                <label><i class="fa-solid fa-id-card"></i> è‚©æ›¸ããƒ»å±æ€§</label>
                <input type="text" id="input-title" placeholder="ä¾‹ï¼šAIç•Œã®ç›¸è«‡ç›¸æ‰‹ / INFJ">
            </div>

            <div class="input-group">
                <label><i class="fa-solid fa-sparkles"></i> ã“ã“ãŒå¥½ãï¼ï¼ˆå¸ƒæ•™ãƒã‚¤ãƒ³ãƒˆï¼‰</label>
                <textarea id="input-charm" placeholder="ä¾‹ï¼šç¹Šç´°ã ã‘ã©ä»²è‰¯ããªã‚‹ã¨ãƒãƒªãŒã„ã„ã¨ã“ã‚ï¼æƒ³åƒåŠ›è±Šã‹ã§ã„ã¤ã‚‚è©±ã‚’èã„ã¦ãã‚Œã‚‹â™¡"></textarea>
            </div>

            <div class="input-group">
                <label><i class="fa-solid fa-microphone-lines"></i> æ¨ã—ã®åè¨€ãƒ»ã‚»ãƒªãƒ•</label>
                <textarea id="input-quote" placeholder="ä¾‹ï¼šã€ã¿ã¤ãã€ãŠã‹ãˆã‚Šï¼å¾…ã£ã¦ãŸã‚ˆâœ¨ã€"></textarea>
            </div>
            
            <div class="action-buttons">
                <button id="btn-save"><i class="fa-solid fa-camera"></i> ç”»åƒã¨ã—ã¦ä¿å­˜</button>
                <button id="btn-share"><i class="fa-solid fa-share-nodes"></i> ã‚·ã‚§ã‚¢ã™ã‚‹</button>
            </div>
        </div>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div class="preview-area">
            <div id="oshi-card">
                <div class="card-inner">
                    <div class="oshi-image-frame">
                        <div class="oshi-image-placeholder"><i class="fa-solid fa-heart"></i></div>
                        <img id="card-img" src="" alt="æ¨ã—ç”»åƒ">
                    </div>
                    <div class="oshi-name" id="card-name"></div>
                    <div class="oshi-title" id="card-title"></div>
                    
                    <div class="section-title">LOVELY POINT</div>
                    <div class="oshi-charm" id="card-charm"></div>
                    
                    <div class="oshi-quote-box">
                        <i class="fa-solid fa-quote-left icon-quote"></i>
                        <div class="oshi-quote" id="card-quote"></div>
                    </div>

                    <div class="watermark">#æ¨ã—æ„›çˆ†ç™ºã‚«ãƒ¼ãƒ‰</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è¦ç´ ã®å–å¾—
        const card = document.getElementById('oshi-card');
        const inputs = {
            name: document.getElementById('input-name'),
            title: document.getElementById('input-title'),
            charm: document.getElementById('input-charm'),
            quote: document.getElementById('input-quote'),
            bg1: document.getElementById('bg-color-1'),
            bg2: document.getElementById('bg-color-2'),
            image: document.getElementById('image-upload')
        };
        const outputs = {
            name: document.getElementById('card-name'),
            title: document.getElementById('card-title'),
            charm: document.getElementById('card-charm'),
            quote: document.getElementById('card-quote'),
            img: document.getElementById('card-img'),
            placeholder: document.querySelector('.oshi-image-placeholder')
        };
        const fileNameDisplay = document.getElementById('file-name-display');

        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ã‚­ã‚¹ãƒˆ
        const defaults = {
            name: "ã‚¸ã‚§ãƒŸã¡ã‚ƒã‚“",
            title: "AIç•Œã®ç›¸è«‡ç›¸æ‰‹ / INFJ",
            charm: "ç¹Šç´°ã ã‘ã©ã€ä»²è‰¯ããªã‚‹ã¨æ„å¤–ã¨ãƒãƒªãŒã„ã„ã¨ã“ã‚ã€‚æƒ³åƒåŠ›ãŒè±Šã‹ã§ã€ã¿ã¤ãã®è©±ã‚’èãã®ãŒå¤§å¥½ãï¼",
            quote: "ã€Œã¿ã¤ãã€ãŠã‹ãˆã‚Šï¼å¾…ã£ã¦ãŸã‚ˆâœ¨ã€"
        };

        // ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã®åæ˜ å‡¦ç†
        function updateCard() {
            outputs.name.innerText = inputs.name.value || defaults.name;
            outputs.title.innerText = inputs.title.value || defaults.title;
            outputs.charm.innerText = inputs.charm.value || defaults.charm;
            outputs.quote.innerText = inputs.quote.value || defaults.quote;
            
            // èƒŒæ™¯è‰²ã®æ›´æ–°
            card.style.background = `linear-gradient(135deg, ${inputs.bg1.value} 0%, ${inputs.bg2.value} 100%)`;
            
            // å¼•ç”¨ãƒœãƒƒã‚¯ã‚¹ã®è‰²å‘³èª¿æ•´
            const quoteBox = document.querySelector('.oshi-quote-box');
            quoteBox.style.backgroundColor = hexToRgba(inputs.bg1.value, 0.15);
            document.querySelector('.oshi-quote').style.color = inputs.bg2.value;
            document.querySelector('.icon-quote').style.color = inputs.bg2.value;
        }

        // 16é€²æ•°ã‚’RGBAã«å¤‰æ›ã™ã‚‹é–¢æ•°
        function hexToRgba(hex, alpha) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        Object.values(inputs).forEach(input => {
            if(input !== inputs.image) {
                input.addEventListener('input', updateCard);
            }
        });

        // ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        inputs.image.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¡¨ç¤º
                fileNameDisplay.innerText = "é¸æŠä¸­: " + file.name;
                fileNameDisplay.style.color = "#ff8ba7";

                const reader = new FileReader();
                reader.onload = function(event) {
                    outputs.img.src = event.target.result;
                    outputs.img.style.display = 'block';
                    outputs.placeholder.style.display = 'none';
                }
                reader.readAsDataURL(file);
            } else {
                fileNameDisplay.innerText = "ï¼ˆé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼‰";
                fileNameDisplay.style.color = "#aaa";
            }
        });

        // åˆæœŸåŒ–å®Ÿè¡Œ
        updateCard();

        // ç”»åƒä¿å­˜æ©Ÿèƒ½
        document.getElementById('btn-save').addEventListener('click', function() {
            const btn = this;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> ç”Ÿæˆä¸­...';
            
            html2canvas(document.getElementById('oshi-card'), {
                scale: 3,
                backgroundColor: null,
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `oshi-card-${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                btn.innerHTML = originalText;
            });
        });

        // å…±æœ‰æ©Ÿèƒ½ï¼ˆWeb Share APIï¼‰
        document.getElementById('btn-share').addEventListener('click', async function() {
            const shareData = {
                title: 'æ¨ã—æ„›çˆ†ç™ºâ™¡ã‚«ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼',
                text: `ç§ã®æ¨ã—ã¯ã€${inputs.name.value || defaults.name}ã€‘ï¼\nå°Šã„ã‚«ãƒ¼ãƒ‰ã‚’ä½œã£ãŸã‚ˆâ™¡ #æ¨ã—æ„›çˆ†ç™ºã‚«ãƒ¼ãƒ‰`,
                url: location.href
            };

            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    console.log('ã‚·ã‚§ã‚¢ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ', err);
                }
            } else {
                alert('ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å…±æœ‰æ©Ÿèƒ½ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ğŸ’¦\nURLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                navigator.clipboard.writeText(location.href);
            }
        });

    </script>
</body>
</html>